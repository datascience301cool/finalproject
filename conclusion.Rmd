---
---
title: "Executive conclusion"
output: html_document
---

```{r}
# Load packages
library(tidyverse)
library(tidymodels)
library(janitor)
library(patchwork)
library(splitstackshape)

# Set seed here!
set.seed(57)

load(file = "data/rf_tune.rda")
load('data/vehicle_setup.rda')
load('data/vehicles_strat.rda')

# Workflow
rf_workflow_tuned <- rf_workflow %>% 
  finalize_workflow(select_best(rf_tune, metric = "rmse"))

# Fitting to training set
rf_results <- fit(rf_workflow_tuned, vehicle_train)

```

## Conclusion and Next Steps

Overall, the random forest model seemed to be pretty accurate in predicting the `price` of a used car on Craigslist given its `year`, `manufacturer`, `condition`, `cylinders`, `fuel`, `odometer`, `title_status`, `transmission`, `drive`, `type`, and `state_region`.

We were curious about how the model would do at predicting the price of a real used car listing on Craigslist. We found a specific listing, a 2005 Ford F-150 XLT, created a data frame containing the car's characteristics, and used this data frame and the random forest model to predict the `price` of the car.

```{r}
# Create data frame for real listing

used_car_listing <- tibble(
  year = 2005, 
  manufacturer = "ford", 
  condition = "good", 
  cylinders = "8 cylinders", 
  fuel = "gas", 
  odometer = 130222, 
  title_status = "clean", 
  transmission = "automatic", 
  drive = "4wd", 
  type = "truck", 
  state_region = "midwest"
)

# Predict price
ex_1 <- predict(rf_results, used_car_listing)

10^ex_1
```

Undoing the log transformation for this truck, the predicted price was $5,428. This was not far off the actual listing price of $5,200. It is possible that this particular listing was underpriced, or that the model overestimated the price. 

Given that this particular listing's `price` was on low side, also wanted to try predicting the `price` of a more expensive listing. We found a listing for a 2018 Jeep Grand Cherokee listed for $29,650. Again, we created a data frame containing the truck's characteristics and used the data frame and the random forest model to predict the `price` of the truck.

```{r}
# Create data frame for real listing

used_car_listing2 <- tibble(
  year = 2018, 
  manufacturer = "jeep", 
  condition = "excellent", 
  cylinders = "6 cylinders", 
  fuel = "gas", 
  odometer = 33894, 
  title_status = "clean", 
  transmission = "automatic", 
  drive = "4wd", 
  type = "SUV", 
  state_region = "midwest"
)

# Predict price
ex_2 <- predict(rf_results, used_car_listing2)

10^ex_2
```

Undoing the log transformation, the predicted `price` ended up being $28,966, which is really close to the actual `price`. We're pretty satisfied with these results, but seeing that the model overestimated the `price` in the first test and then underestimated it in the second test, we think that the model could be improved.

As for next steps, seeing the random forest model best three others makes us confident that this would be the best way to go for accuracy - especially looking at the closeness of the results given real data. However, we may want to try adjusting some tuning parameters to make this model even more accurate. 

Ultimately, we're quite satisfied with the predictive accuracy of the random forest model given the amount of time we had to work on the project. We believe it could be a useful tool for used car shoppers who are trying to assess the pricing of a particular listing. However, if given more time, our next steps would be to try new tuning parameters to get an even lower RMSE.